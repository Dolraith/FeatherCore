

<div class="control-group">
    <h3>Spirits   <button class="btn btn-primary" v-on:click="addSpirit">Add Spirit</button></h3>
</div>
<hr>
<div v-for="(spirit,spiritIndex) in spiritList">
    <div class="card">
        <div class="card-body container">
            <div class='row form'>
                <div class="col-sm">
                    <label class="font-weight-bold">Type</label>
                    <select v-model="spirit.type" class="form-control" v-on:change="forceTypeEleCompliance(spiritIndex)">
                        <option v-for="type in types">{{type}}</option>
                    </select>
                </div>
                <div class="col-sm">
                    <label class="font-weight-bold">Element</label>
                    <select v-model="spirit.element" class="form-control" v-on:change="calcSpirit(spiritIndex)">
                        <option v-for="element in elements[spirit.type]">{{element}}</option>
                    </select>
                </div>
                <div class="col-sm">
                    <label class="font-weight-bold">Force</label>
                    <select v-model="spirit.force" class="form-control" v-on:change="calcSpirit(spiritIndex)">
                        <option v-for="i in 20">{{i}}</option>
                    </select>
                </div>
                <div class="col-sm">
                    <label class="font-weight-bold">Spirit Noticibility</label>
                    <div>{{getSpiritVisibility(spirit.force)}}</div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-sm">
                    Body: <b>{{spirit.body}}</b><br>
                    Strength:  <b>{{spirit.strength}}</b><br>
                    Intuition: <b>{{spirit.intuition}}</b><br>
                    Physical Initiative: {{spirit.phys_init}}<br>
                </div>
                <div class="col-sm">
                    Agility: <b>{{spirit.agility}}</b><br>
                    Willpower: <b>{{spirit.willpower}}</b><br>
                    Charisma: <b>{{spirit.charisma}}</b><br>
                    Astral Initiative: {{spirit.astral_init}}<br>
                </div>
                <div class="col-sm">
                    Reaction: <b>{{spirit.reaction}}</b><br>
                    Logic: <b>{{spirit.logic}}</b><br>
                    Magic: <b>{{spirit.magic}}</b>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class='col-3'>Phys Condition:</div>
                        <div class="col-9">
                            <input disabled v-bind:checked="i<=spirit.condition_phys_cur" v-for="i in spirit.condition_phys_max" type="checkbox">
                        </div>
                    </div>
                    <div class="row">
                        <div class='col-3'>Stun Condition:</div>
                        <div class="col-9">
                            <input disabled v-bind:checked="i<=spirit.condition_stun_cur" v-for="i in spirit.condition_stun_max" type="checkbox">
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-group">
                            <button class="btn btn-secondary btn-sm form-control" v-on:click="damage(spiritIndex, true)">Heal</button>
                            <select v-model="spirit.cur_dmg_val" class="form-control">
                                <option v-for="i in 20">{{i}}</option>
                            </select>
                            <select v-model="spirit.cur_dmg_mode" class="form-control">
                                <option value="phys">Physical</option>
                                <option value="stun">Stun</option>
                            </select>
                            <button class="btn btn-secondary btn-sm form-control" v-on:click="damage(spiritIndex, false)">Damage</button>
                        </div>
                    </div>
                </div>
                <div class="col">
                    Modifier: <b>{{spirit.pool_modifier}}</b>
                </div>
            </div>
            <hr>
            <!---Skills-->
            <div class="row" v-if="spirit.skillDetails" v-on:click="toggleSkillDetails(spiritIndex)">
                <table class="table table-striped">
                    <thead>
                        <th>Skill [-]</th>
                        <th>Pool</th>
                        <th>Attribute</th>
                    </thead>
                    <tbody>
                        <tr v-for="skill in spirit.skills">
                            <td>{{skill.name}}</td>
                            <td>{{skill.pool}}</td>
                            <td>{{skill.attribute}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="row" v-if="spirit.skillDetails == false" v-on:click="toggleSkillDetails(spiritIndex)">
                <b>Skills: [+]</b>
                <div>{{condenseSkills(spirit)}}</div>
            </div>
            <hr>
            <!---Powers-->
            <div class="row">
                <div><b>Powers</b></div>
                <div>Required: <span class="badge badge-secondary" v-for="power in spirit.powers.required" v-on:click='setPowerTooltip(power)' data-bs-toggle='modal' data-bs-target='#powerExplanation'>{{power.name}} <i class="bi bi-question-circle"></i></span></div>       
                <div>Optional: <div v-if='spirit.powers.picked.length > spirit.powers.numOptional' class="margin-left: 15px; badge badge-danger">!Too Many Powers!</div> 
                    <button v-on:click="pickPowers(spirit, spiritIndex)" class="badge badge-primary" data-bs-toggle="modal" data-bs-target="#powerPickModal"><i class="bbi bi-wrench"></i></button>
                    <span style="margin-right: 5px;" class="badge badge-secondary" v-for="power in spirit.powers.picked" v-on:click='setPowerTooltip(power)' data-bs-toggle='modal' data-bs-target='#powerExplanation'>{{power.name}} <i class="bi bi-question-circle"></i></span>
                </div>
            </div>
        </div>
        <button class="btn btn-primary btn-sm" v-on:click="removeSpirit(spiritIndex)">X</button>
    </div>
</div>

<div class="modal fade" id="powerPickModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Pick Powers  <div v-bind:class="(optionalPowers.picked.length>optionalPowers.numOptional)?'badge badge-danger':'badge badge-success'">{{optionalPowers.picked.length}}/{{optionalPowers.numOptional}}</div></h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-striped">
            <thead>
                <th>Picked</th>
                <th>Name</th>
                <th>Description</th>
            </thead>
            <tr v-for="option in optionalPowers.options">
                <td>
                    <label class="form-check-custom">
                        <input type="checkbox" v-model="optionalPowers.picked" v-bind:value="option._id"/>
                    </label>
                </td>
                <td>{{option.name}}</td>
                <td>
                    <button class='btn btn-secondary'  v-if="option.showDescription == false" v-on:click="showModalPowerDescription(option,true)">Show Description</button>
                    <div v-if="option.showDescription == true">
                        <button class='btn btn-secondary' v-on:click="showModalPowerDescription(option,false)"> Hide Description</button><br>
                        {{option.descript}}
                    </div>
                </td>
            </tr>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" v-on:click="pickPowersOk()">OK</button>
        </div>
      </div>
    </div>
</div>


<div class="modal fade" id="powerExplanation" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">{{powerTooltip.power.name}}</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-sm">
                    <b>Name:</b> {{powerTooltip.power.name}}<br>
                    <b>Range:</b> {{powerTooltip.power.power_range}} 
                </div>
                <div class="col-sm">
                    <b>Type:</b> {{powerTooltip.power.type}}<br>
                    <b>Action:</b> {{powerTooltip.power.action}}
                </div>
                <div class="col-sm">
                    <b>Duration:</b> {{powerTooltip.power.duration}}<br>
                    <b>Source:</b> {{powerTooltip.power.source}}
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-lg">
                    {{powerTooltip.power.descript}}
                </div>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" v-on:click="pickPowersOk()">OK</button>
        </div>
      </div>
    </div>
</div>  